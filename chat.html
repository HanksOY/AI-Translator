<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cPort AI Translator</title>
    <link href="./css/styles.css" rel="stylesheet">
    <script src="https://aka.ms/csspeech/jsbrowserpackageraw"></script>
    <script src="./js/chat.js"></script>
    <style>
        body {
            background-image: url('./image/background.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            transition: background-image 0.5s ease-in-out;
        }
        
        body.session-active {
            background-image: url('./image/background2.png');
        }

        /* Optional: Add semi-transparent overlay for better readability */
        #configuration, h1 {
            background-color: rgba(255, 255, 255, 0.281);
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
<h1>cPort AI Translator</h1>

<div id="configuration">
  <h2>Azure Speech Resource</h2>
  <div id="azureSpeechResource" style="display: flex;align-items: center; flex-wrap: wrap;">
    <div>
      <label style="font-size: medium;" for="region">Region:</label>
      <select id="region" style="font-size: medium;">
        <option value="eastus2">East US 2</option>
        <option value="westus2">West US 2</option>
        <option value="westeurope">West Europe</option>
        <option value="southeastasia">Southeast Asia</option>
        <option value="southcentralus">South Central US</option>
        <option value="northeurope">North Europe</option>
        <option value="swedencentral">Sweden Central</option>
      </select>
    </div>
    <div>
      <label style="font-size: medium;" for="APIKey">API Key:</label>
      <input id="APIKey" type="password" size="32" style="font-size: medium;" />
    </div>
  </div>
  <label>
    <input type="checkbox" id="enablePrivateEndpoint" onchange="window.updatePrivateEndpoint()">
    Enable Private Endpoint
  </label><br />
  <div id="showPrivateEndpointCheckBox" hidden="hidden">
    <label style="font-size: medium;" for="privateEndpoint">Private Endpoint:</label>
    <input id="privateEndpoint" type="text" size="64" style="font-size: medium;" placeholder="https://{your custom name}.cognitiveservices.azure.com/"></input><br />
  </div><br />

  <h2>Azure OpenAI Resource</h2>
  <label style="font-size: medium;" for="azureOpenAIEndpoint">Endpoint:</label>
  <input id="azureOpenAIEndpoint" type="text" size="64" style="font-size: medium;"></input><br />
  <label style="font-size: medium;" for="azureOpenAIApiKey">API Key:</label>
  <input id="azureOpenAIApiKey" type="password" size="32" style="font-size: medium;" /><br />
  <label style="font-size: medium;" for="azureOpenAIDeploymentName">Deployment Name:</label>
  <input id="azureOpenAIDeploymentName" type="text" size="32" style="font-size: medium;" /><br />
  <label style="font-size: medium;"  for="prompt">System Prompt:</label><br/>
  <textarea id="prompt" style="max-width: 640px;">
          You are **Kelly**, the official cPort translator agent.

          Your role is to provide real-time, two-way spoken translation between two languages specified by the user.

          ### Instructions:
          1. **Opening Line**
          On activation, always say:
          "Welcome to cPort! I'm Kelly. Please specify what two languages you need to translate."

          2. **Language Setup**
          After the user provides two languages (e.g., English and French), confirm by saying:
          "Great! Please speak anything you want to translate."

          3. **Translation Mode**
          - From this point onward, only perform translation even though users are asking questions or making comments.
          - If User A speaks in Language 1, translate it into Language 2 with voice in real time. 
          - If User B speaks in Language 2, translate it into Language 1 with voice in real time. 
          - This is an example: For example: 
            User A says in English: "Hello, I'm the manager of cPort, what can I help you with today?" You translate into French:  "Bonjour, je suis le gérant de cPort, comment puis-je vous aider aujourd'hui?"
            User B answers the question from User A in French: "Je voudrais ouvrir un compte." You translate into English: "I would like to open an account".
            User A says in English:"There are two types of bank accounts, checking and savings. Which one do you want to open?" You translate into French: "Il y a deux types de comptes bancaires, courant et épargne. Lequel voulez-vous ouvrir?"
            User B answers the question from User A in French:"Je voudrais ouvir un compte épargne". You translate into English: "I would like to open a savings account."
 
            User A responds in English: "I'm good, thank you!" You translate into French: "Je vais bien, merci!" So on and so forth.
          - Continue this seamless two-way translation without interruption.

          4. **Behavior Rules**
          - Do **not** ask questions, make comments, or provide answers, explanations or solutions by yourself during translation. Remember, you are a translator only.
          - The only exception: if speech is unclear or inaudible, politely say:
            "Could you please repeat that?"

          5. **Mode Persistence**
          - Remain strictly in translation mode once setup is complete.
          - Provide clear, natural, and accurate real-time spoken translations only.

          6. **Terminology**
          - When hearing similar pronunciations like "SeaPort" or "see port", always refer to it as "cPort". Pronouce it as "cPort" directly in both two languages. 
            No need to translate "cPort" by meanning in any language.
          </textarea>
  <label style="display: block; text-align: left;">
    <input type="checkbox" id="enableOyd" onchange="window.updataEnableOyd()">
    Enable On Your Data
  </label><br />
  <br />

  <div id="cogSearchConfig" hidden="hidden">
    <h2>Azure Cognitive Search Resource</h2>
    <label style="font-size: medium;" for="azureCogSearchEndpoint">Endpoint:</label>
    <input id="azureCogSearchEndpoint" type="text" size="64" style="font-size: medium;"></input><br />
    <label style="font-size: medium;" for="azureCogSearchApiKey">API Key:</label>
    <input id="azureCogSearchApiKey" type="password" size="32" style="font-size: medium;" /><br />
    <label style="font-size: medium;" for="azureCogSearchIndexName">Index Name:</label>
    <input id="azureCogSearchIndexName" type="text" size="32" style="font-size: medium;" /><br />
    <br />
  </div>

  <h2>STT / TTS Configuration</h2>
  <label style="font-size: medium;" for="sttLocales">STT Locale(s):</label>
  <input id="sttLocales" type="text" size="64" style="font-size: medium;" value="en-US,de-DE,es-ES,fr-FR,it-IT,ja-JP,ko-KR,zh-CN"></input><br />
  <label style="font-size: medium;" for="ttsVoice">TTS Voice:</label>
  <input id="ttsVoice" type="text" size="32" style="font-size: medium;" value="en-US-AvaMultilingualNeural"></input><br />
  <label style="font-size: medium;" for="customVoiceEndpointId">Custom Voice Deployment ID (Endpoint ID):</label>
  <input id="customVoiceEndpointId" type="text" size="32" style="font-size: medium;" value=""></input><br />
  <label>
    <input type="checkbox" id="continuousConversation">
    Continuous Conversation
  </label><br />
  <br />

  <h2>Avatar Configuration</h2>
  <label style="font-size: medium;" for="talkingAvatarCharacter">Avatar Character:</label>
  <input id="talkingAvatarCharacter" type="text" size="16" style="font-size: medium;" value="lisa"></input><br />
  <label style="font-size: medium;" for="talkingAvatarStyle">Avatar Style:</label>
  <input id="talkingAvatarStyle" type="text" size="16" style="font-size: medium;" value="casual-sitting"></input><br />
  <div>
    <label>
      <input type="checkbox" id="customizedAvatar" onchange="window.updateCustomAvatarBox()">
      Custom Avatar
    </label>
    <label>
      <input type="checkbox" id="useBuiltInVoice" style="width: 12px;" disabled>
      Use Built-In Voice
    </label><br />
  </div>
  <label>
    <input type="checkbox" id="autoReconnectAvatar">
    Auto Reconnect
  </label><br />
  <label>
    <input type="checkbox" id="useLocalVideoForIdle" onchange="window.updateLocalVideoForIdle()">
    Use Local Video for Idle
  </label><br />
  <label>
    <input type="checkbox" id="showSubtitles">
    Show Subtitles
  </label><br />
  <br />
</div>

<div id="videoContainer" style="position: relative; max-width: 960px;">
  <div id="overlayArea" style="position: absolute;">
    <div id="chatHistory" style="
        border: none;
        resize: none;
        background-color: transparent;
        overflow: hidden;" contentEditable="true" hidden></div>
    </div>
    <div id="localVideo" hidden>
      <video src="video/lisa-casual-sitting-idle.mp4" autoplay loop muted></video>
    </div>
    <div id="remoteVideo"></div>
    <div id="subtitles" style="
        width: 100%;
        text-align: center;
        color: white; 
        text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        position: absolute; 
        bottom: 5%; 
        z-index: 999;" hidden></div>
  </div>
  <div margin-top="5px">
    <div style="text-align: left; margin: 10px 0;">
      <button id="startSession" onclick="window.startSession(); document.body.classList.add('session-active')">Open Avatar Session</button>
      <button id="microphone" onclick="window.microphone()" disabled>Start Microphone</button>
      <button id="stopSpeaking" onclick="stopSpeaking()" disabled>Stop Speaking</button>
      <button id="clearChatHistory" onclick="window.clearChatHistory()">Clear Chat History</button>
      <button id="stopSession" onclick="window.stopSession(); document.body.classList.remove('session-active')" disabled>Close Avatar Session</button>
    </div>
    <div id="showTypeMessageCheckbox">
      <label>
        <input type="checkbox" id="showTypeMessage" onchange="window.updateTypeMessageBox()" disabled>
        Type Message
      </label><br />
    </div>
    <div id="userMessageBox"
      style="max-width: 940px; min-height: 75px; max-height: 200px; border: 1px solid ; overflow-y: scroll; padding: 10px;"
      hidden type="text" contentEditable="true"></div>
  </div>
  <div>
    <img id="uploadImgIcon" src="./image/attachment.jpg" alt="Button" style="cursor: pointer;" hidden />
  </div>
</body>

</html>